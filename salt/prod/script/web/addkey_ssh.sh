#!/bin/bash
# Dete:2016/06/27
# Description:添加用户sshkey到.ssh/authorized_keys
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
unset User Group

User="$1"
Group="$2"
Originalpwd=$(pwd)
User_sshkey="${User}_sshkey"

hujf_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBALfIEvxPxDgBtBx21QcXNt3+MZqJ1S3jTAyGvphKrd4o1qnEH8wTndsjucm2V8MW7utQqfhIAp8IOkDbmeFjrZz2AdUCnTcQCurcTQHk+o+Rwa4EpYioYvTSC1p7BSwS3tgLdCYEmst/MK96ycOWz09RzBmiyDokKMiM7wHa50pvAAAAFQCoVAzx827iSZQNM38jgqAD3Vv8PQAAAIEAosOvg72Ir4HxC7tzpchkvrXDBCrd7mlKFzWWSYb9nRbHPq6NmXnwo8073wcX8G3R3xTANttrbfeUQ2AnX9OJGhBJKk+dQxU7mg/q57nmz382CUZDht/cc+gpIjZuHVEdJrHS4ILIAaxCgsvEZa9hPj6B4tOC9kHUfTmgmXmPMJ0AAACAQqCmw5QH5FCiiQhzk1YfFH5AKljsE45IliyhwmbnQXaUCEvWTQ2d4o4TxlIoCoMTxj+HKDG7MKG2lQw4a1s2pIDGV8eGuVvJRRj/7T2uTx8jodZKH+qIlP8NUaQWrikgWcpLKWzmpsO+Ojqxb16vqIAKP0Z5WGdD8c2awvj6QX0="
huangzhx_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBANItq6NKIvqOcb/NhQEfNEy6VXZ6kkdjYWDrZ/DLaV6WBAXMXoFe3HghJMBi1Jg1HQ9GqXQ7znFd6ZgXT7isuZ1mwvGBCZU2fgcrHR2ze1Q6fJ2tdTb004sG1Mo1Crw/E39eSYYnoT8g8gqmYDuEkc8xukLYocNHmJBnHeAqT3rlAAAAFQD1DF3O8uRBjmJJZ2eMnoZzQ5+44QAAAIAtlUx/qTrI0geWbi7BOE4/gvbysznhh1CKYyJqZvbWqKGbBe0kCKgfNzVFyokJno8cEQI0l3LwzvZRuxIC7WVQ0lQXdNRtw4mMcM4dcfqBu0V+rmoof1L5BIXgnAJh+r/f3YpXgzCoOO47aKxgFnGxP/lRiuJA3MOUpy8JgcHqlAAAAIAIErGbRZsUHM5p2VASOyS2VKWG4P80/3lWTCaXIdA+/dZRZX+J7vX0TcMdmDShFH1fTqAE2hPgDr45maZesI0pr2YR/coPmcCuPGtYjteM+dlk3n1ccYrFhegVvSfsdhqQEISgXagcz1IAiIReOB7oxmndiPVE1+lXnGSrhny6iA=="
sheab_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAJkQ1n3mCIkiuDVY4Fyg+Pk9fZyaL2I33Gm2pYIrAQgKc+UnTkKUAxU15bZInUcBaATIX5AHg9Oq9RttqtsfmvHzHqiMuErCXaClckuMk9Y9ImgVs3PotRQ/9cAV0eowXQ5BVFRuwXQw3ysaFQLBogbFAJgzuuuPavz1TaON8xFzAAAAFQDYIlHhpZAeeFNtfSwjSaz2I2sR3QAAAIB8OUW059hXsTyDJpCXzNtjBWs+fMHkterGU8LCpKzf04D0F2jU3Mr4e6pfpgTtLs2c8f994wFoe7l4Y8cCaH6Y3hdP3QYWNcIvy0nIGOMh/mJ6vWd+FrwREJF5RmPesHU5yDP/TnnT05jns8sIweSvPNP39Z/ogPJTDGUzGA3ecQAAAIBOeNpuUi8XH3BlxxN2fBDiZQRTswcp4Ho5jmOUiiEWYceni4fz8IggACzMsWhtvLoTTI1ozOBR1y4IeShdywmltY16mMkFdY8XYSn2kPJ/KAIGzdYSaNX6mv1PsE9r39bGrYXqSe6+wjcAHeUdC566dKYC9Ql5Mf51wo/+Y2Lv8g=="
zhangmsh_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAMXMOX+BYtx5Mnf4pQofhLzherzfcrfG6iKIG2T2CgnUrk3P6auO/ab2ecQ2csztjFbtyIozqnPE4riM/yXhZ2EE7LY1CyH62Vt9dMFhLsQ6TNzCXz2eleP0X64dadPYwKNT7/Zc3Bj6oAUE32/Cx8DCb2Xkg8x7pNU62VG6KFWDAAAAFQC1jHnJLzX6Dk1dH85T/9BtHIIXpwAAAIAAzoAMRVV9z6lXW/Mgnxv+nqx7HUBQbQ2uaE+JCRfoTLEZjL0QNFWFbzHMC2wNCprUtRvHhsPVa8kCoWR29mzbp2N/uoFjSNUWeaORTOcwSQ7J+YnNTbngQePfVaTStFpTiO7wDPJOPdzi28qrD3hRetiGRgQru5hjJQEs3Uy7NQAAAIAvgmqcC+LUHrYci9QZu/HOBJddyOpkCnXtUHIfqZsl+DshOc/zbWjYPJnezkdyRRsguAhEvRiVtfmOn1A5gQcbFcQreL3/ycO51bZWjsnSUYchWPQ9/fhi2Oeransi1LAdt5XNFNrCocpBDSaTnTyQQGsaaEp8+ks3fUPp0WR/5A=="
yejq_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAJEtAyxEBUItK490a1gMzIR6ZgU98C32UlwDRUOWkGQlYPcGRPU4gq0D46MNMgB4SEx3yO1+NP7xnhcwkraSPbhkOT/qtZngRiKLWVsLWXVYohsDTHWm+L34zgezzvJEPAohvI1YxeMdzqLjHZhs0z76Oxypw7oQ44QYCjB1K+Y/AAAAFQDqFpH+Q1YBph3AU+NU+0STmuci9wAAAIAgzl2eTVHi1q2nk8LExHO/yxBJtBOYjVNrxrJ8QFSafp9AjE3IKmVLMglfW4gmiuhNQPWbUBPBaxNR105ctucsTnGSgMw6Pkz8MnucVyp+pY/sP/Ql3nxkQ8NvOg1fe6/F/UBlBKwiqecoFX5DvYb3KlvDXFHpQzUQvhNfjNhjggAAAIEAiBFXkvb7k5uv5GsacKu76c6KgLe0ek/gFfr7fNSzYXlcwGv5zo+8NvN5iZlD7M7dYICHBcHJyDo7GHyPJ6uz0tfugRUI/C6lFYMD4PorHQFZFvFRLJdw+f3GVMVGn4fneYWEKQJFMK6KMI/jAHrvRHhiD2HcnbLEFGeEvVu/OGE="
hexing_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBALerfV+vpbcaRvZ4SfB7rm0VMtwX8A/1qTCwS40qTXDuyE8+ruDyEK7cIRLv+RWYaz18MUOs91zWbcE7mKvYjzzwCw9kLqmhnVwuKpBs2I3MpXoXxWXFM5jnbyt+LVukUS+SgwK5ODyd4f3Fvcsg1h5Om94//x0TD3dxXHs53sWzAAAAFQDdJg37FDMKTLKTjAYlmFMPL0e/SwAAAIBMaIob7b1c497JVRQn85vN5pe28z4Lit9FFQBsswRas8h9iFNzjiSuhp9SmFj54VCSWCJ1zF/s/UnAcEqgpZYrmCi3iF2DaxS7BFaHme4tCmOv3pNKYl+HaB4sr9NPdpsx9FprJ5l+5mKjgxN/r5PEAvGgSNp4zJwGXTzYKpK4WgAAAIBLIsPzfI1/sdr/LVhQeRBqUCce4+oZug4qErKyKUVz9R9eOP+LGlbBqS0AWMGztFwlE9M3iOPy+YkaF0C9IL3NJqfW/2GLBgBLKBkFlkyiuyMxDxOQQj3TWBLcui50834nBf+np9sA9jxGWDU56ALlLX1ZuCmBpKtu3QxEQTdfEg=="
zhuoqh_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAKiFf5fBs/zZeW7+053ROOt9JqZo3Qyygcw2gyJeQ6iNLgUsacyQOWofDMviyD99OIl4kXcYa2IFKouHb486IwbjsrB01dD0/Iz/X6dTcDPM4ZYyRRUExk831LCyd+qdR2W7OJMNdN2JUBVGpp5Tu+MpK8IoW9W+2aRo+B6ZUQP7AAAAFQCDHvrKre+bQZ88BiAnJanBxvNw3wAAAIB91xBwPV2aKwKcI3bxI4isMe05zk4+4VC+BXLl9CPg6Y5DOpPrH/cNaY1ieNDRFeKBazwMCJUQYYeAqwDzvXSk29SW01DZrwNwjM21IFjnLo1ulrpGUZHODWeWpUgXUUg5VA6qWgdffZp1WMT7yK4sAvdVaQHag0z1e5r5CdWgNwAAAIB4m1pQUC8uBsDVAwUnbuKPOIBC9idzrPf2sAxz2BhKHqMmMdBWBvqjNY0YbQok1DOJF3AnVd/fX7mFTxfahvxhXgkPfN22D3/4oAdTJpEPqgH8hw+1mAcyiisVHBvHx1b2o2T9YrIBW0Yjn4P8q83eaXGG4b0K0tIsj2hg2xVgag=="
huangdw_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBANkEzJazLTGh7hjTFiGCSAirmwQeNCBry+4AfPhSJELRKjCGGCAJSWU5EYgO/A4jwLnp1qV8+XblHHy4cPN/SP65DU9OCP87Aq9Jr12Sb3tdbFMHvgkEjmU+BGG1JK3mS4xwj9l/2WILyeSwEnZnbUreDO548/9hjM1k0bML3w1rAAAAFQDkZB4i0p90NZvvbU7AnXWyfMljwwAAAIB8WzKd7XBXd5EknTZGZmSKlxzxnKxTSmFrlqovZKLP2NZzgzcXBIRQOwFC6CmN1cPfQQSIg6Isusud52QZyb2qZDH1hYhUrIhRmQeoEyAek9I9Sa3ZRQ/wAq+1VTBbZ9c9LQ2ksjxjZ0Bz1G+Ih8MvUCHa1q4F1YuVRYcwLVspYwAAAIEAySyGmM+Nq5KV8ys6gFqmpjeczhwoPeyRaDdUqYIilQ2dtfnEWVz6AR0UVWY3Z3Gl9ZfdOE2NeQ2r1Vjo93eMMuaZrn/3AmxL+zQJouT7Pcx+QemmPTusx+n9pT1RWRo8Sk3+pl2qx2HsJY9jhKhtTgr+mtgs9y9WpYtOALrJZVw="
wujf_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAOF3QtxIOMr7sJLl1dhxt5UT//ncnRIFfEXuT7BmnJnNYAX1mJvb+b2I8eJ5bBzsy0H2ybL/CguaGqEM9BL8/VH56hwXY1yzZJRiWaVUy4YB/I5NlMhHgvl4IA3rhy5D3wAUSd5v8t3MEfOCw4pi/quzTW3DVvy04Im+6X4cXdx1AAAAFQDViUAQFwJda3R6+14xzActAJAh8QAAAIAb5GiM6pCLKdbVi3u3t09y78DDheA0LQOKoz88MvXVFp1Yb+WYHFPOh6+iqYDBjz1UtdahNAkKPq4wYSRmB/slbVcCDda/7eh8H6V7GZIB7T2Ldr4J6eF8SwA8TNYg93Ogp+Nffx9EgUmg5Xl9cKsOEdwobGWnkegKE4KAl4TfMQAAAIBq2BtouC4IuGauwSAgTJ3nKJat3HUg+gDLNmsZZ/ulbwq9lQELiLODoVBvc2nidPKANTHsGBK+RykxtVp77TzNkXP0R4EoVOxLMzsJLmdjLHDB2Q3zXabsXdsG+sZ/zsZRvXGy51jnNwvFiZgf8NFAApPHo4j5yVGss1gqVHoZSQ=="
chenpy_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAIgxmB3jH4c1ee48erBNvjPMxD9mwT+Y7MQ/kUo3pN3vky06pJcFO+XnGBn1KhM5r6SxtibE4tRhdjl9HJaNIaNGE/1LLxQNrrRgeH22BozdEQbK8J+zB0xQZR21zMGEzO4WBFTEvXoM0CSJrpBNHzu61Gqm5/2z3Qv7Nd2yW1GBAAAAFQDtZ6LDBzSOZ0IQKxS5FP12agB78QAAAIBdoo9rj6VFUQAqLizp6Us4fsC5EviaejJdYxrGcarZr923wnsy+joyqA57YJIZLEQCZEPLpur5Yhi0uiSO0M0crtIa6ZKfhahLSmzYXzcyUPyljhnNHk8lZXOg0gHR59rkjZhiKYJtDj8ng1+XS/nveLaBE/YnXq5g9SLdEGp2wgAAAIB+ECnp4QB+cbzVaQqn7b/LkzsAKlHshfN4l7umhUqhMduWmkQAYgo263W6MLqcdHl6sx4IUizLcjeJQgmjqtCY7clC7t08PloQ4lkvd0w63lki+PpE6te1Z8lbM5dpU60VgCwJXch8bHCjOnb0pVormmq+of6LJs+fYQxpUSc32A=="
xiaolq_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAIyDuPTioAMc7+gCTMyD6tDNi6TqpEAMlOGNYxtWl7cx83gp1ovZ7yeZP9TdfVphbxO3Jnh9VGcqGxiFd6xExIkcyEuTW9QN6bjFjxsweDeZW+FRvsqvTqLiI3JRYdGlkoLttehpNg/UAWceji+0+Agccbp6d9rpp3M+FRmfztIDAAAAFQD53EynWWsAn0+LMIJVEZF6+gzZSQAAAIAw4PCwAR4s/QwFoC+rqHpxyN8StCnZBkhIVUORlgpwlxwg/7ME6KAgKA6y5vd69Wl8IGuyLYJtKY0SDaPtiv31p08dhA9UaDksTBYdbM2s0Mzy/X6fT0bsB7U2w4v6+8OmDk2fyoCQdzoZMi5LKiLx4ueMiPywuaSjKSYTQxns0AAAAIBCBZFl3TrYb3ipnq0HcGXcku3IYAb/3lxe5SJWHlJsQDiYmmvIsY3o0ug7bxpOdgG8WrUKmmuRKTu4il5k7rqvREKXeiL5wxHKydu8cTxK4JU0WczrAEYDSUVbKUIXXRiObzf8ncmSDr+1UA/6laZ0oJ/Xgp8SBnBJYfG4sS3kHQ=="
zengjx_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAJIHfwZF2etKWN6GOav5TE3QoQZh66EYBtXHYzoGXTkHavkg6T4WlW5v5DFKdjR/0Nes8JOQIR5qItgV2nJgo3USPki+uHmZq0v0oHAEMfCOPo0qpEpOgQnViVPfDnQdUjUoXbQCAm9PLSM1BcjL7oZ1J+fUJ5Q00xJlvsUc8d/NAAAAFQDhf6HXMGQF5kg9bcQIvXarAC/qrwAAAIAr3eHHSTO0QENl5xL2675kDLGF4UuHluUqs3PIwtxIjx6/4rb1Myqira4Dkv3FGFbQY3NGM0+5+fq+rdrC8L5k67ioWEvIJKTen/at0hnnIqr6mmD0qv5yvHumNE65up8Bd1ZRvbnAwoU5cBPLUjdEGoewBJxm8jAAZ+c/YRl9NgAAAIAoVlUP2HoHCQYMRDxmem+qdib/Zm2BioGATQ/y9W6V82gC3o55XCGJVfobwoL/cNkoaIFtyA/i1Kuqb/Wr0crMxyugP0h7vpFo7EiqD22hsgEE12nQ6dEYzN2Fug5lCr+35zRw7oomhg2xzriri3Xm/Q8kj/X0Rc3hQE1rl5pOkA=="
lizhy_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAPwh5xqtk4ea8MGOBgUT6re/5TF1guoi1qwXApd17wmirVZMCV+rnETi7cB03J8UQfyh3bVRkS2eb8vgJU1r485DZvwxAMxDBqI6X2c6760PRzIaiZwRDlfRaYqa/Zwl1k8NNVRSQxdP7YXBaN16R0VLXnxvl/buqTX+sRdyR4mTAAAAFQCjNqAS0Enx77jLFeksZTXVOGFjgwAAAIAGaVMR/U7A0nQr83zojZnuV3eSvyoxwaGKN6+E7xMm+iZJgQUrouHUgMPAas48NcBTnMp6r7qeBahqp/qErDtBNdju44PJz1yF4gXr6X6Mfzi56G339Sick5tS6iUUigaDAOQ76LCRV/Uh7neGMO1u2Hf0c9799ApUtd0O7S2+fAAAAIEAp7PiOoM0KnwbYZlag2BNWtBIsj7UMutQBPeJIlDGGyPjLqWg1n72XeKSkGDbNfT/8mPwLuqf+qYWmchYWFfkn6NSTWMDJGGgahchgJWgOyT/YFJVZooWgHRIgpRMqdXAWiFL1e4eACi4AN8HSuDxZcYmqj+BTaN19iqY6wlVK6o="
chengshj_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAPu0tTZqrAOCG3kUs6nF1xIBEKZvl7YDHKc/36bgIb/SbIYEUtX6KW3JicL4XRPNM5Oo3z8N4GrjZpwy0T9zipa4X1fh+6M26eS/TJyAt2jCJEJcNPIDwTA3KSh1tKgnGcYK1Pd7EGGqZTvKPxHXD8x9IWeBcEJW4HcN2PJ2UwdvAAAAFQCeB5rFkXTKol4ZIqIn/84a9sxLzwAAAIEAkfpN4uMH1WyIk7DqZ66/OyVGrGuP816kUnjHAp/Gf+dzug5F2dkVELbGsgSCtfqPGuLAThYA5Pm3Hodekg+IPSdTWpqWIBrtj1O1bx5GQ5U9LC2u0HybWv2PuSPDjBKLf1BP4cyGXShbPlN2abOHkvmjA44A/fdxxZM2CFbi+D8AAACATcoRolajRnQzD7qtnNpfvxzS1RA410pwEHhqafvHvyi0SBN8MwlVwQU+oFosn9et5po98GLfgf6oGJte89qqviJcgpWmunI6bJ0mBVXEQPDAfabME2VHfvAqhncd+0ok3EkPrYFg43p4UdVst4GHCYRVICT9Cu3TqhqPs3KOkVQ="
linjq_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAPx/dIj+XIbTxPX1asMFN6zSGiTcyI1qCluf+OE0Rx8twMmLKCzqyNjoTgiN4VS0PIg1fKt3s45/cnRV6xld6j7lvQwCIRtALcl2k6OBaYxxn5swbbCGDUUWq8lPkjDpHEPC7IWYoijnfekBZaeucY5YdM70R6u02a0N0vO17F1BAAAAFQDItZY3CcvM80w6qalb+lcZPu29KwAAAIBd10wQop0ViX3QGDQorYQD5Jj1NEMsLa+RaHdn6UfG/hhlA9mvbsUoNm4vBUC9zMXjVZhKr+cC1pmd8TvFj8ncSx7tCubq+lLTsvkfzBPd4jecZRIET92oDgGU2dpADjbggisrbSff/mo0uBAOwqucZabP2tk01l76CyAMzgUQWAAAAIEA3+bF2rs3yQdX7yAjqJrSejKm37HDxojDCDP68hVsk296iVfv612nbeYH1nCCUp0VTC87WGN29xWHjEkHFnXeTEU07lT7B3Ue5ZehNrtaUtNHWYEDg/2zup4srgl5Axq7WZinqpezcoMNWPxhhu690m9nGEsWQt4DRYLwShqDVIc="
chenyi_sshkey="ssh-dss AAAAB3NzaC1kc3MAAACBAIhKUOWO42EUZI+5ViHoy79lmp8Xz3zQDshJg/TRQW51bbYDp5FSWRY8mScqo5jzA50Lz7K4pN1D5WBg1qbHtxwmtQoWhTG0VPnCOeuqLVfrXjpm9lXYZyZ3esbPzfZZUaR7WsB0ZDF0b9InjgqCjOetBWBXS++8oB94Kw5aOfR9AAAAFQDkBsTOkDwEpyViySMlwRKBpa4DhwAAAIAKkJjAP04wRzV0LXWkLYw/d3slwbOS+EWbZx6Yg8ADUrbb46xpdgF1M1l02e9vZdYLk+bnjWfp2qZ57+qhxWtTLP6Xgd2kfh4Wr5DVNCPbE0++aiLRtupOF64HNxTjG+0wKMH50rEmhgsCJdgCqPiBxkBsO1W5daA/P9ubki6gOwAAAIBzY+Gx08LbZfzOOLdpq5FnQCwhfqdr1LESfwXYYvPNEQPNEd9d3yeB+ZSsFGXsvrmOlP8CLMiQ7+kEptgKjy8/KtNlEdQtzjlJZcldo7XFT8QyWVSlz65wEtxXpPakHx6oEwygr+ijFVAkcHXeuOuJaDLL4iH0PNaQl9kZAL/g1Q=="

# 判断脚本传参，打印脚本用法
if [[ "$#" -ne 2 ]];then
	echo "Wrong number of argvs"
	echo "Usage: $0 {hujf|xiedh|yejq...} {admin|super|ftp|tomcat}"
	exit 1
fi

# 检查用户是否在上文的提供范围内
if [[ -z ${!User_sshkey} ]];then
	echo "Warning:Undefine user"
	exit 1
fi

# 限定group组只能为super|ftp|tomcat|admin
if [[ "$Group" != "super" && "$Group" != "ftp" && "$Group" != "tomcat" && "$Group" != "admin" ]];then
	echo "Warning:Undefine group"
	exit 1
fi

# 限制admin只能添加hujf
if [[ "$Group" == "admin" ]];then
	if [[ "$User" != "hujf" ]];then
		echo "Warning:Only user of hujf can add in group of admin" 
		exit 1
	fi
fi

# 检查用户组是否已存在
gid=$(grep "^$Group:" /etc/group | awk -F":" '{print $3}')
if [[ -z "$gid" ]];then
	echo "Warning:Group $Group does not exists on system"
	exit 1
fi

# 检查用户是否已存在
uid=$(grep "^$User:" /etc/passwd | awk -F":" '{print $3}')
if [[ -n "$uid" ]];then
	usermod -G $Group $User
	mkdir -p /home/$User/.ssh
	chown $User:$Group /home/$User/.ssh
	chmod 700 /home/$User/.ssh
	echo "${!User_sshkey}" > /home/$User/.ssh/authorized_keys
	echo "addkey $User sucess!"
else
	# 创建用户并添加sshkey
	useradd $User -g $Group
	mkdir -p /home/$User/.ssh
	chown $User:$Group /home/$User/.ssh
	chmod 700 /home/$User/.ssh
	echo "${!User_sshkey}" > /home/$User/.ssh/authorized_keys
	echo "addkey $User sucess!"
fi
